<?xml version="1.0" encoding="utf-8"?>
<winex:WindowEx
    Title="DropStack"
    x:Name="WindowMain"
    x:Uid="WindowMain"
    x:Class="DropStackWinUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DropStackWinUI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:winex="using:WinUIEx" 
    Width="500" Height="800" MinWidth="500" MaxWidth="750" MinHeight="273" IsMaximizable="False">

    <Window.SystemBackdrop>
        <MicaBackdrop Kind="Base"/>
    </Window.SystemBackdrop>

    <Grid x:Name="EverythingGrid" PointerMoved="EverythingGrid_PointerMoved" PointerEntered="EverythingGrid_PointerEntered" PointerExited="EverythingGrid_PointerExited">
        <ParallaxView x:Name="ThemeBackgroundParallaxView" Source="{Binding ElementName=regularFileListView}" VerticalShift="500" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Image x:Name="ParallaxImage" HorizontalAlignment="Center" VerticalAlignment="Stretch" Stretch="UniformToFill" Opacity="0.25"/>
        </ParallaxView>
        <Frame x:Name="ThemeFrame" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
        <Grid x:Name="WindowGrid" Opacity="1">
            <Grid.OpacityTransition>
                <ScalarTransition/>
            </Grid.OpacityTransition>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Rectangle x:Name="TitleBarRectangle" Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0"/>
            <TextBlock x:Name="TitleBarText" x:Uid="TitleBar" Grid.Row="0" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="10,5,0,0"/>
            <Grid x:Name="ContentGrid" Grid.Row="1" HorizontalAlignment="Stretch">
                <Grid x:Name="RegularAndPinnedFileGrid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="10,50,10,0">
                    <Grid.TranslationTransition>
                        <Vector3Transition/>
                    </Grid.TranslationTransition>
                    <Grid.Resources>
                        <CommandBarFlyout x:Name="FileCommandsFlyout">
                            <AppBarButton x:Name="FlyoutOpenButton" x:Uid="ContextMenuButtonOpen" Icon="OpenFile" Click="FlyoutOpenButton_Click"/>
                            <AppBarButton x:Name="FlyoutCopyButton" x:Uid="ContextMenuButtonCopy" Icon="Copy" Click="FlyoutCopyButton_Click"/>
                            <AppBarButton x:Name="FlyoutPreviewButton" x:Uid="ContextMenuButtonPreview" Icon="View" Click="DetailsPanePreviewButton_Click"/>
                            <AppBarButton x:Name="FlyoutRotateButton" x:Uid="ContextMenuButtonRotate" Icon="Rotate" Click="DetailsPaneRotateButton_Click"/>
                            <CommandBarFlyout.SecondaryCommands>
                                <AppBarButton x:Name="FlyoutOpenWithButton" x:Uid="ContextMenuButtonOpenWith" Icon="OpenWith" Label="Open with..." Click="DetailsPaneOpenWithButton_Click"/>
                                <AppBarButton x:Name="FlyoutRevealButton" x:Uid="ContextMenuButtonReveal" Icon="MoveToFolder" Click="FlyoutRevealButton_Click"/>
                                <AppBarButton x:Name="FlyoutSelectButton" x:Uid="ContextMenuButtonSelect" Icon="SelectAll" Click="FlyoutSelectButton_Click"/>
                                <AppBarButton x:Name="FlyoutDeleteButton" x:Uid="ContextMenuButtonDelete" Icon="Delete" Click="FileDeleteButton_Click"/>
                            </CommandBarFlyout.SecondaryCommands>
                        </CommandBarFlyout>
                    </Grid.Resources>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Rectangle x:Name="PinnedExpanderBackgroundRectangle" Grid.Row="0" Fill="DarkGray" Opacity="0" RadiusX="4" RadiusY="4" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,10">
                        <Rectangle.OpacityTransition>
                            <ScalarTransition/>
                        </Rectangle.OpacityTransition>
                    </Rectangle>
                    <Expander
                        x:Name="PinnedFilesExpander"
                        x:Uid="PinnedFilesExpander"
                        ExpandDirection="Down"
                        VerticalAlignment="Top"
                        Grid.Row="0"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch"
                        AllowDrop="True"
                        DragOver="PinnedPivotSection_DragOver"
                        Drop="PinnedPivotSection_Drop"
                        IsExpanded="False"
                        Expanding="Expander_Expanding"
                        Collapsed="PinnedFilesExpander_Collapsed"
                        Margin="0,0,0,10">
                        <Grid>
                            <StackPanel x:Name="WinHelloWaitingIndicator" Visibility="Collapsed" Spacing="10" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <ProgressRing x:Name="WinHelloProgressRing" IsActive="False" VerticalAlignment="Center"/>
                                <TextBlock x:Uid="WaitingForWindowsHelloAuth" FontSize="15" VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock x:Name="NoPinnedFilesTextBlock" x:Uid="NoPinnedFiles" FontSize="15" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <StackPanel x:Name="NoPinnedFolderStackpanel" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed">
                                <TextBlock x:Name="NoPinnedFolderTextBlock" x:Uid="NoPinnedFolder" FontSize="15"/>
                                <HyperlinkButton x:Name="PickPinnedFolderHyperlinkButton" x:Uid="SetPinnedFolderHyperlink" FontSize="15" HorizontalAlignment="Center" VerticalAlignment="Center" ClickMode="Press" Click="PickPinnedFolderHyperlinkButton_Click"/>
                            </StackPanel>
                            <Grid x:Name="pinnedFileGrid" Height="125" Margin="-15,-15,-15,-15">
                                <ScrollViewer HorizontalScrollMode="Enabled" VerticalScrollMode="Disabled" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" Margin="0,0,0,-5">
                                    <GridView   x:Name="pinnedFileListView"
                                                SelectionChanged="fileListView_SelectionChanged" 
                                                DoubleTapped="regularFileListView_DoubleTapped"
                                                RightTapped="fileListView_RightTapped" 
                                                CanDragItems="True" 
                                                DragItemsStarting="fileListView_DragItemsStarting"
                                                DragItemsCompleted="pinnedFileListView_DragItemsCompleted"
                                                Height="150"
                                                HorizontalAlignment="Stretch">
                                        <GridView.ItemContainerTransitions>
                                            <TransitionCollection>
                                                <EntranceThemeTransition  FromVerticalOffset="0" />
                                            </TransitionCollection>
                                        </GridView.ItemContainerTransitions>
                                        <GridView.ItemTemplate>
                                            <DataTemplate x:Name="pinnedFilesDataTemplate">
                                                <Grid HorizontalAlignment="Center" Width="180">
                                                    <Button x:Name="RemovePinnedFileButton" x:Uid="RemovePinnedFileButton" Opacity="0.8" HorizontalAlignment="Right" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                                        <FontIcon Glyph="&#xE77A;" />
                                                        <Button.Flyout>
                                                            <Flyout>
                                                                <StackPanel>
                                                                    <TextBlock x:Uid="UnpinFileFlyoutPrompt" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                                    <Button x:Name="DeletePinnedItemConfirmationButton" x:Uid="UnpinFileFlyoutConfirm" HorizontalAlignment="Center" Click="DeletePinnedItemConfirmationButton_Click" Background="DarkRed" Foreground="White"/>
                                                                </StackPanel>
                                                            </Flyout>
                                                        </Button.Flyout>
                                                    </Button>
                                                    <StackPanel Orientation="Vertical" Spacing="0" HorizontalAlignment="Stretch">
                                                        <Image x:Name="Thumbnail" Source="{Binding FileIcon}" Width="70" Height="70" Stretch="Uniform" Margin="0,5,0,0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        <StackPanel Orientation="Vertical" Spacing="1" HorizontalAlignment="Stretch" Margin="20,0,20,5">
                                                            <TextBlock Text="{Binding FileDisplayName}" FontSize="20" TextTrimming="CharacterEllipsis" HorizontalAlignment="Center" HorizontalTextAlignment="Center" Margin="0,0,0,10"/>
                                                            <StackPanel Margin="0,-9,0,0" HorizontalAlignment="Center">
                                                                <StackPanel Orientation="Horizontal" Spacing="5" HorizontalAlignment="Center">
                                                                    <TextBlock Text="{Binding FileType}" FontSize="10" HorizontalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                                                    <TextBlock Text="-" FontSize="10"/>
                                                                    <TextBlock Text="{Binding FileSize}" FontSize="10"/>
                                                                    <TextBlock Text="{Binding FileSizeSuffix}" FontSize="10"/>
                                                                </StackPanel>
                                                            </StackPanel>
                                                            <TextBlock x:Name="PathBlock" Text="{Binding FilePath}" Visibility="Collapsed"/>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </GridView.ItemTemplate>
                                    </GridView>
                                </ScrollViewer>
                            </Grid>
                        </Grid>
                    </Expander>
                    <Grid Grid.Row="1">
                        <Grid x:Name="regularFileGrid">
                            <Grid.TranslationTransition>
                                <Vector3Transition/>
                            </Grid.TranslationTransition>
                            <Rectangle x:Name="ContentBackgroundRectangle" Fill="White" Opacity="0.5" RadiusX="4" RadiusY="4" Margin="0,0,0,-10">
                                <Rectangle.OpacityTransition>
                                    <ScalarTransition/>
                                </Rectangle.OpacityTransition>
                            </Rectangle>
                            <ListView   x:Name="regularFileListView"
                                        Margin="0,2,0,0"
                                        SelectionMode="Extended"
                                        SelectionChanged="fileListView_SelectionChanged" 
                                        DoubleTapped="regularFileListView_DoubleTapped"
                                        RightTapped="fileListView_RightTapped"
                                        CanDragItems="True" 
                                        DragItemsStarting="fileListView_DragItemsStarting"
                                        DragItemsCompleted="regularFileListView_DragItemsCompleted"
                                        ShowsScrollingPlaceholders="True"
                                        FlyoutBase.AttachedFlyout="{x:Bind FileCommandsFlyout}"
                                        ContextFlyout="{x:Bind FileCommandsFlyout}"
                                        Tapped="regularFileListView_Tapped">
                                <ListView.ItemContainerTransitions>
                                    <TransitionCollection>
                                        <EntranceThemeTransition  FromVerticalOffset="0" />
                                    </TransitionCollection>
                                </ListView.ItemContainerTransitions>
                                <ListView.ItemTemplate>
                                    <DataTemplate x:Name="FilesDataTemplate">
                                        <Grid x:Name="regularFileInfoStackpanel" HorizontalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid Grid.Column="0">
                                                <Image x:Name="Thumbnail" Source="{Binding FileIcon}" Opacity="{Binding IconOpacity}" Width="43" Height="43" Stretch="Uniform" Margin="-5,3,5,3" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                <ProgressRing IsActive="{Binding ProgressActivity}"/>
                                            </Grid>
                                            <Grid Grid.Column="1" HorizontalAlignment="Stretch" Tag="{Binding FilePath}" Opacity="{Binding TextOpacity}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="35"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Grid.Row="0" Text="{Binding FileName}" FontSize="20" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Stretch" Margin="0,5,0,0"/>
                                                <Grid Grid.Row="1" Margin="0,0,0,5" HorizontalAlignment="Stretch">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="10"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="3"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="10"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding FileType}" FontSize="10"/>
                                                    <TextBlock Grid.Column="2" Text="{Binding FileSize}" FontSize="10"/>
                                                    <TextBlock Grid.Column="4" Text="{Binding FileSizeSuffix}" FontSize="10"/>
                                                    <TextBlock Grid.Column="6" Text="{Binding ModifiedDate}" FontSize="10"/>
                                                </Grid>
                                                <TextBlock x:Name="PathBlock" Text="{Binding FilePath}" Visibility="Collapsed"/>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Grid>
                </Grid>
                <CommandBar x:Name="FileCommandBar" Background="Transparent" IsOpen="False" DefaultLabelPosition="Right" HorizontalAlignment="Right">
                    <AppBarButton x:Name="SearchButton" x:Uid="CommandBarSearchButton" Icon="Find" Click="SearchButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="F" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton x:Name="CopyLastSelectedButton" x:Uid="CommandBarCopyButton" Icon="Copy" Click="CopyLastSelectedButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="C" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton x:Name="RefreshButton" x:Uid="CommandBarRefreshButton" Icon="Refresh" Click="RefreshButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="R" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton x:Name="RevealInExplorerButton" x:Uid="CommandBarRevealButton" Icon="MoveToFolder">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="E" />
                        </AppBarButton.KeyboardAccelerators>
                        <AppBarButton.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem x:Name="PrimLinkToExplorerDisplay" Text="[PrimFolder]" Click="RevealInExplorerButton_Click" Tag="prim"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem x:Name="Sec1LinkToExplorerDisplay" Text="[SecFolder1]" Click="RevealInExplorerButton_Click" Tag="sec1"/>
                                <MenuFlyoutItem x:Name="Sec2LinkToExplorerDisplay" Text="[SecFolder1]" Click="RevealInExplorerButton_Click" Tag="sec2"/>
                                <MenuFlyoutItem x:Name="Sec3LinkToExplorerDisplay" Text="[SecFolder1]" Click="RevealInExplorerButton_Click" Tag="sec3"/>
                                <MenuFlyoutItem x:Name="Sec4LinkToExplorerDisplay" Text="[SecFolder1]" Click="RevealInExplorerButton_Click" Tag="sec4"/>
                                <MenuFlyoutItem x:Name="Sec5LinkToExplorerDisplay" Text="[SecFolder1]" Click="RevealInExplorerButton_Click" Tag="sec5"/>
                                <MenuFlyoutSeparator x:Name="SecondRevealMenuDivider"/>
                                <MenuFlyoutItem x:Name="PinsLinkToExplorerDisplay" Text="[PinsFolder]" Click="RevealInExplorerButton_Click" Tag="pins"/>
                            </MenuFlyout>
                        </AppBarButton.Flyout>
                    </AppBarButton>
                    <AppBarButton x:Name="SelectModeButton" x:Uid="CommandBarSelectButton" Icon="SelectAll" Click="SelectModeButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="Q" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton x:Name="LaunchSimpleModeButton" x:Uid="CommandBarLaunchSimpleModeButton" Icon="Go" Click="LaunchSimpleModeButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="S" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton x:Name="LaunchMiniModeButton" x:Uid="CommandBarLaunchMiniModeButton" Icon="Go" Click="LaunchMiniModeButton_Click">
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator Modifiers="Control" Key="M"/>
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <CommandBar.SecondaryCommands>
                        <AppBarButton x:Name="QuickSettingsButton" x:Uid="CommandBarSettingsButton" Icon="Setting" Click="QuickSettingsButton_Click">
                            <AppBarButton.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Control" Key="I" />
                            </AppBarButton.KeyboardAccelerators>
                        </AppBarButton>
                    </CommandBar.SecondaryCommands>
                </CommandBar>
                <Grid x:Name="SearchGrid" VerticalAlignment="Top" HorizontalAlignment="Stretch" Opacity="0" Visibility="Collapsed" Translation="0,-60,0" Height="40" Margin="12,60,12,0">
                    <Grid.TranslationTransition>
                        <Vector3Transition/>
                    </Grid.TranslationTransition>
                    <Grid.OpacityTransition>
                        <ScalarTransition/>
                    </Grid.OpacityTransition>
                    <Rectangle x:Name="SearchBackgroundRectangle" Fill="White" Opacity="0.25" RadiusX="4" RadiusY="4">
                        <Rectangle.OpacityTransition>
                            <ScalarTransition/>
                        </Rectangle.OpacityTransition>
                    </Rectangle>
                    <TextBox x:Name="SearchTextBox" x:Uid="SearchBox" Height="15" Margin="4,4,4,4" TextChanged="SearchTextBox_TextChanged"/>
                </Grid>
                <TeachingTip x:Name="fileInClipboardReminder"
                             x:Uid="CopiedSuccessfully"
                             PreferredPlacement="Top">
                    <ProgressBar x:Name="reminderTimer" Value="0" />
                </TeachingTip>
                <TeachingTip x:Name="failedToDragTeachingTip"
                             x:Uid="DragFailed"
                             PreferredPlacement="Top">
                    <ProgressBar x:Name="failureReminderTimer" Value="0" />
                </TeachingTip>
                <TeachingTip x:Name="panosUnlockedTeachingTip"
                             x:Uid="HiddenThemeUnlocked"
                             ActionButtonClick="panosUnlockedTeachingTip_ActionButtonClick">
                    <ProgressBar x:Name="panosUnlockedTimer" Value="0" />
                </TeachingTip>
                <TeachingTip 
                            x:Name="noFolderpathTechingTip"
                            x:Uid="NoFolder"
	                        PreferredPlacement="Center"
	                        PlacementMargin="20"
	                        IsLightDismissEnabled="False"
	                        ActionButtonClick="noFolderpathTechingTip_ActionButtonClick"/>
                <TeachingTip 
                            x:Name="noPinnedFolderpathTechingTip"
                            x:Uid="NoPinnedFolderPath"
	                        PreferredPlacement="Center"
	                        PlacementMargin="20"
	                        IsLightDismissEnabled="False"
	                        ActionButtonClick="noPinnedFolderpathTechingTip_ActionButtonClick"/>

                <Grid x:Name="OOBEgrid" Margin="20,20,20,20" Visibility="Collapsed">
                    <Grid.OpacityTransition>
                        <ScalarTransition />
                    </Grid.OpacityTransition>
                    <Grid.TranslationTransition>
                        <Vector3Transition />
                    </Grid.TranslationTransition>
                    <Rectangle x:Name="OOBEbackgroundRectangle" Fill="DarkGray" Opacity="0.25" RadiusX="8" RadiusY="8"/>
                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                        <Pivot x:Name="OOBEpivot" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" SelectionChanged="OOBEpivot_SelectionChanged" Margin="0,-30,0,0">
                            <PivotItem>
                                <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,0,0,50">
                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock Text="👋" FontSize="92" HorizontalAlignment="Center"/>
                                        <TextBlock x:Uid="OOBEWelcome" FontSize="40" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                        <TextBlock x:Uid="OOBEWelcomeSubtitle" FontSize="18" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                        <TextBlock Height="10"/>
                                        <TextBlock x:Uid="OOBEStartSetup" FontSize="12" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                    </StackPanel>
                                </Grid>
                            </PivotItem>
                            <PivotItem>
                                <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,0,0,50">
                                    <TextBlock x:Uid="OOBESetupTitle" FontSize="25" VerticalAlignment="Top" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                    <Pivot x:Name="OOBEsetupPivot" SelectionChanged="OOBEsetupPivot_SelectionChanged">
                                        <PivotItem>
                                            <ScrollViewer VerticalAlignment="Center">
                                                <StackPanel Spacing="20" VerticalAlignment="Center">
                                                    <TextBlock Text="📂" FontSize="92" HorizontalAlignment="Center"/>
                                                    <TextBlock x:Uid="OOBEPickPortal" FontSize="40" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                                    <TextBlock x:Uid="OOBEPickPortalExplanation"
                                                       FontSize="18" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                                    <TextBlock Height="10"/>
                                                    <Button x:Name="OOBEportalFileAccessRequestButton" x:Uid="OOBEPickPortalButton" Click="OOBEportalFileAccessRequestButton_Click" Style="{StaticResource AccentButtonStyle}" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </ScrollViewer>
                                        </PivotItem>
                                        <PivotItem>
                                            <ScrollViewer VerticalAlignment="Center">
                                                <StackPanel Spacing="20" VerticalAlignment="Center">
                                                    <TextBlock Text="📌" FontSize="92" HorizontalAlignment="Center"/>
                                                    <TextBlock x:Uid="OOBEPickPins" FontSize="40" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                                    <TextBlock x:Uid="OOBEPickPinsExplanation" 
                                                   FontSize="18" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                                    <TextBlock Height="10"/>
                                                    <Button x:Name="OOBEpinnedFileAccessRequestButton" x:Uid="OOBEPickPinsButton" Click="OOBEpinnedFileAccessRequestButton_Click" Style="{StaticResource AccentButtonStyle}" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </ScrollViewer>
                                        </PivotItem>
                                    </Pivot>
                                </Grid>
                            </PivotItem>
                            <PivotItem>
                                <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,0,0,50">
                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock Text="🤗" FontSize="92" HorizontalAlignment="Center"/>
                                        <TextBlock x:Uid="OOBEDone" FontSize="40" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                        <TextBlock x:Uid="OOBEDoneSubtitle" FontSize="18" HorizontalAlignment="Center" TextWrapping="WrapWholeWords"/>
                                        <CheckBox x:Uid="OOBESimpleModeAsDefaultOfferCheckbox" x:Name="OOBEsimpleViewOfferCheckBox" IsChecked="False" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </PivotItem>
                        </Pivot>
                        <Button x:Name="OOBEgoBackButton" x:Uid="OOBEBackButton" Click="OOBEgoBackButton_Click" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="10,0,0,10"/>
                        <Button x:Name="OOBEgoNextButton" x:Uid="OOBENextButton" Click="OOBEgoNextButton_Click" VerticalAlignment="Bottom" HorizontalAlignment="Right" Style="{StaticResource AccentButtonStyle}" Margin="0,0,10,10"/>
                    </Grid>
                </Grid>

                <Grid x:Name="AboutDropStackGrid" Visibility="Collapsed" Opacity="0">
                    <Grid.OpacityTransition>
                        <ScalarTransition/>
                    </Grid.OpacityTransition>
                    <Rectangle Fill="Black" Opacity="0.4" Margin="0,-100,0,0" Tapped="Rectangle_Tapped"/>
                    <Rectangle RadiusX="8" RadiusY="8" MaxWidth="500" Margin="20,20,20,20" Fill="{ThemeResource AcrylicBackgroundFillColorDefaultBrush}" Opacity="1"/>
                    <Grid x:Name="AboutDropStackContentGrid" MaxWidth="500" Margin="20,20,20,20" VerticalAlignment="Stretch" Translation="0,50,0">
                        <Grid.TranslationTransition>
                            <Vector3Transition/>
                        </Grid.TranslationTransition>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock x:Uid="SettingsTitle" Grid.Row="0" FontSize="15" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        <Button    Grid.Row="0" x:Name="AboutDropStackCloseButton" Background="Transparent" BorderBrush="Transparent" HorizontalAlignment="Right" VerticalAlignment="Top" CornerRadius="8" Click="AboutDropStackCloseButton_Click">
                            <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE711;"/>
                        </Button>
                        <ScrollViewer Grid.Row="1" Margin="10,10,10,10">
                            <StackPanel>
                                <Expander x:Name="AppearanceAndBehaviorExpander" x:Uid="SettingsAppearanceBehaviorExpander" HorizontalAlignment="Stretch" Margin="0,10,0,5">
                                    <StackPanel HorizontalAlignment="Stretch">
                                        <ComboBox x:Name="LaunchModePickerComboBox"
                                                  x:Uid="SettingsLaunchModePicker"
                                          Margin="-1,0,-1,10"
                                          HorizontalAlignment="Stretch"
                                          SelectionChanged="LaunchModePickerComboBox_SelectionChanged">
                                            <ComboBoxItem x:Uid="SettingsLaunchModeNormal" />
                                            <ComboBoxItem x:Uid="SettingsLaunchModeSimple" />
                                            <ComboBoxItem x:Uid="SettingsLaunchModeMini" />
                                        </ComboBox>
                                        <ToggleSwitch x:Uid="SettingsSimpleModeWindowing" x:Name="SimpleModeWindowingToggle"
                                              Toggled="SimpleModeWindowingToggle_Toggled"/>
                                        <ToggleSwitch x:Name="PinToolbarInSimpleModeToggleSwitch" x:Uid="SettingsMiniModePinToolBar"
                                                Toggled="PinToolbarInSimpleModeToggleSwitch_Toggled"/>
                                        <ComboBox x:Name="CheckBoxBehaviorCombobox" x:Uid="SettingsCheckBoxBehavior" Margin="-1,5,-1,5" HorizontalAlignment="Stretch" SelectionChanged="CheckBoxBehaviorCombobox_SelectionChanged">
                                            <ComboBoxItem x:Uid="SettingsCheckboxBehaviorNever"/>
                                            <ComboBoxItem x:Uid="SettingsCheckboxBehaviorWhenTurnedOnInExplorer"/>
                                            <ComboBoxItem x:Uid="SettingsCheckboxBehaviorAlways"/>
                                        </ComboBox>
                                        <Grid>
                                            <ComboBox x:Name="ThemePickerCombobox" x:Uid="SettingsThemePicker" Margin="-1,0,40,10" HorizontalAlignment="Stretch" SelectionChanged="ThemePickerCombobox_SelectionChanged">
                                                <ComboBoxItem x:Uid="SettingsThemeDefault" Tag="Default"/>
                                                <ComboBoxItem x:Uid="SettingsThemeColorful" Tag="Colorful"/>
                                                <ComboBoxItem x:Uid="SettingsThemeEvening" Tag="Evening"/>
                                                <ComboBoxItem x:Uid="SettingsThemeBliss" Tag="Bliss"/>
                                                <ComboBoxItem x:Uid="SettingsThemeThunderstorm" Tag="Thunderstorm"/>
                                                <ComboBoxItem x:Name="PanosThemeOption"  x:Uid="SettingsThemeEasterEgg" Tag="Panos" Visibility="Collapsed"/>
                                            </ComboBox>
                                            <ToggleButton x:Name="ToggleThemeAnimationsButton" Translation="0,9,0" Width="32" Height="32"  HorizontalAlignment="Right" Checked="ToggleThemeAnimationsButton_Checked" Unchecked="ToggleThemeAnimationsButton_Unchecked">
                                                <FontIcon Glyph="&#xF4A5;" Margin="-10,-10,-10,-10" />
                                            </ToggleButton>
                                        </Grid>
                                        <NumberBox x:Name="SearchThresholdNumberBox"
                                                   x:Uid="SettingsSearchLeniency"
                                           SmallChange="1"
                                           LargeChange="1"
                                           Minimum="0"
                                           Maximum="5"
                                           HorizontalAlignment="Stretch"
                                           SpinButtonPlacementMode="Compact"
                                           ValueChanged="SearchThresholdNumberBox_ValueChanged"/>
                                        <TextBlock x:Uid="SettingsSearchLeniencyDescription"
                                           TextWrapping="WrapWholeWords"
                                           HorizontalAlignment="Center"
                                           Opacity="0.7"
                                           FontSize="10"/>
                                        <ToggleSwitch x:Name="ShowDetailsPaneToggleSwitch"
                                                      x:Uid="SettingsPreferDetailsSheet"
                                                      IsOn="False"
                                                      Toggled="ShowDetailsPaneToggleSwitch_Toggled"/>
                                    </StackPanel>
                                </Expander>
                                <Expander x:Name="PerformanceSettingsExpander" x:Uid="SettingsPerformanceExpander" HorizontalAlignment="Stretch" Margin="0,0,0,5">
                                    <StackPanel Spacing="10" Margin="-25,0,-25,0">
                                        <TextBlock HorizontalAlignment="Stretch"
                                                   x:Uid="SettingsReflectedAfterReloading"
                                           Margin="0,0,0,5"/>
                                        <NumberBox x:Name="RegularFileCapNumberBox"
                                                   x:Uid="SettingsLoadedItems"
                                           SmallChange="100"
                                           LargeChange="500"
                                           Minimum="1"
                                           HorizontalAlignment="Stretch"
                                           SpinButtonPlacementMode="Compact"
                                           ValueChanged="RegularFileCapNumberBox_ValueChanged"/>
                                        <NumberBox x:Name="ThumbnailCapNumberBox"
                                                   x:Uid="SettingsLoadedThumbnails"
                                           SmallChange="50"
                                           LargeChange="200"
                                           Minimum="0"
                                           HorizontalAlignment="Stretch"
                                           SpinButtonPlacementMode="Compact"
                                           ValueChanged="ThumbnailCapNumberBox_ValueChanged"/>
                                        <NumberBox x:Name="ThumbnailResolutionNumberBox"
                                                   x:Uid="SettingsLoadedThumbnailResolution"
                                           SmallChange="2"
                                           LargeChange="10"
                                           Minimum="20"
                                           HorizontalAlignment="Stretch"
                                           SpinButtonPlacementMode="Compact"
                                           ValueChanged="ThumbnailResolutionNumberBox_ValueChanged"/>
                                        <Button x:Name="ResetCapsToDefaultButton"
                                                x:Uid="SettingsResetLoadedItemsValues"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,10,0,0"
                                        Click="ResetCapsToDefaultButton_Click"/>
                                    </StackPanel>
                                </Expander>
                                <Expander x:Name="SecondaryFolderSettingsExpander" x:Uid="SettingsSecondaryFolderSettingsExpander" HorizontalAlignment="Stretch" Margin="0,0,0,5">
                                    <StackPanel Spacing="10" Margin="-25,0,-25,0">
                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxPrimary" x:Name="PrimaryPortalFolderCheckBox"    Margin="-25,0,0,0" Grid.Column="0" Grid.Row="0" Checked="PrimaryPortalFolderCheckBox_Checked" Unchecked="PrimaryPortalFolderCheckBox_Unchecked"/>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxSecondary1" x:Name="SecondaryPortalFolder1CheckBox" Margin="-25,0,0,0" Grid.Column="0" Grid.Row="1" Tag="1" Checked="SecondaryPortalFolderCheckBox_Checked" Unchecked="SecondaryPortalFolderCheckBox_Unchecked"/>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxSecondary2" x:Name="SecondaryPortalFolder2CheckBox" Margin="-25,0,0,0" Grid.Column="0" Grid.Row="2" Tag="2" Checked="SecondaryPortalFolderCheckBox_Checked" Unchecked="SecondaryPortalFolderCheckBox_Unchecked"/>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxSecondary3" x:Name="SecondaryPortalFolder3CheckBox" Margin="-25,0,0,0" Grid.Column="0" Grid.Row="3" Tag="3" Checked="SecondaryPortalFolderCheckBox_Checked" Unchecked="SecondaryPortalFolderCheckBox_Unchecked"/>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxSecondary4" x:Name="SecondaryPortalFolder4CheckBox" Margin="-25,0,0,0" Grid.Column="0" Grid.Row="4" Tag="4" Checked="SecondaryPortalFolderCheckBox_Checked" Unchecked="SecondaryPortalFolderCheckBox_Unchecked"/>
                                            <CheckBox x:Uid="SettingsPortalFolderCheckBoxSecondary5" x:Name="SecondaryPortalFolder5CheckBox" Margin="-25,0,0,0" Grid.Column="0" Grid.Row="5" Tag="5" Checked="SecondaryPortalFolderCheckBox_Checked" Unchecked="SecondaryPortalFolderCheckBox_Unchecked"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="PrimaryPortalFolderChangeButton"    Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="0" HorizontalAlignment="Stretch" Click="PrimaryPortalFolderChangeButton_Click"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="SecondaryPortalFolder1ChangeButton" Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="1" HorizontalAlignment="Stretch" Tag="1" Click="SecondaryPortalFolderChangeButton_Click"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="SecondaryPortalFolder2ChangeButton" Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="2" HorizontalAlignment="Stretch" Tag="2" Click="SecondaryPortalFolderChangeButton_Click"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="SecondaryPortalFolder3ChangeButton" Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="3" HorizontalAlignment="Stretch" Tag="3" Click="SecondaryPortalFolderChangeButton_Click"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="SecondaryPortalFolder4ChangeButton" Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="4" HorizontalAlignment="Stretch" Tag="4" Click="SecondaryPortalFolderChangeButton_Click"/>
                                            <Button x:Uid="SettingsPortalFoldersSetNew" x:Name="SecondaryPortalFolder5ChangeButton" Margin="0,2,-20,2" Grid.Column="1" Width="130" Grid.Row="5" HorizontalAlignment="Stretch" Tag="5" Click="SecondaryPortalFolderChangeButton_Click"/>
                                        </Grid>
                                        <Button x:Name="ApplyMultiFolderSettings" x:Uid="SettingsPortalFolderPreferencesApply" HorizontalAlignment="Stretch" Click="ApplyMultiFolderSettings_Click"/>
                                        <Button x:Name="deleteFolderCookieButton"
                                                x:Uid="SettingsPortalFoldersRevokeAccess"
                                                Background="DarkRed"
                                                Foreground="White"
                                                VerticalAlignment="Bottom"
                                                HorizontalAlignment="Stretch"
                                                HorizontalContentAlignment="Center">
                                            <Button.Flyout>
                                                <Flyout Opened="Flyout_Opened">
                                                    <StackPanel Spacing="10">
                                                        <TextBlock MaxWidth="300" x:Uid="SettingsPortalFoldersRevokeAccessConfirmationTitle" 
                                                                    Style="{ThemeResource BaseTextBlockStyle}"   
                                                                    TextWrapping="WrapWholeWords"/>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="50"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBox Grid.Column="0" x:Uid="SettingsPortalFoldersRevokeAccessPortalPath" x:Name="RegularFolderPathDisplay" MaxWidth="250" IsReadOnly="True"/>
                                                            <Button  Grid.Column="1" x:Name="CopyRegularFolderPathButton" Margin="5,0,0,0" Click="CopyRegularFolderPathButton_Click" VerticalAlignment="Bottom">
                                                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE8C8;"/>
                                                            </Button>
                                                        </Grid>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="50"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBox Grid.Column="0" x:Uid="SettingsPortalFoldersRevokeAccessPinsPath" x:Name="PinnedFolderPathDisplay" MaxWidth="250" IsReadOnly="True"/>
                                                            <Button  Grid.Column="1" x:Name="CopyPinnedFolderPathButton" Margin="5,0,0,0" Click="CopyPinnedFolderPathButton_Click" VerticalAlignment="Bottom">
                                                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE8C8;"/>
                                                            </Button>
                                                        </Grid>
                                                        <Button Click="disconnectFolderButton_Click" 
                                                                x:Uid="SettingsPortalFoldersRevokeAccessConfirmButton"
                                                                Background="DarkRed"
                                                                Foreground="White"
                                                                HorizontalAlignment="Stretch"/>
                                                    </StackPanel>
                                                </Flyout>
                                            </Button.Flyout>
                                        </Button>
                                    </StackPanel>
                                </Expander>
                                <Expander x:Name="ExpanderSettingsExpander" x:Uid="SettingsPinsBehavior" HorizontalAlignment="Stretch" Margin="0,0,0,5">
                                    <StackPanel Spacing="10">
                                        <RadioButtons Header="Options:">
                                            <RadioButton x:Uid="SettingsPinsBehaviorOpen" x:Name="PinsAlwaysOpenRadioButton" Tag="opened" Checked="RadioButton_Checked"/>
                                            <RadioButton x:Uid="SettingsPinsBehaviorRemember" x:Name="PinsRememberStateRadioButton" Tag="remember" Checked="RadioButton_Checked"/>
                                            <RadioButton x:Uid="SettingsPinsBehaviorClosed" x:Name="PinsAlwaysClosedRadioButton" Tag="closed" Checked="RadioButton_Checked"/>
                                            <RadioButton x:Uid="SettingsPinsBehaviorProtect" x:Name="PinsProtectedRadioButton" Tag="protected" Checked="RadioButton_Checked"/>
                                            <RadioButton x:Uid="SettingsPinsBehaviorHide" x:Name="PinsHiddenRadioButton" Tag="hidden" Checked="RadioButton_Checked"/>
                                        </RadioButtons>
                                        <Button x:Name="EnableAllOptionsForPinsButton" x:Uid="SettingsPinsEnableOptions" HorizontalAlignment="Stretch" Click="EnableAllOptionsForPinsButton_Click" Visibility="Collapsed"/>
                                    </StackPanel>
                                </Expander>
                                <Expander x:Name="AboutDropStackExpander" 
                                          x:Uid="SettingsAppInfoExpander" 
                                          HorizontalAlignment="Stretch" 
                                          IsExpanded="False" 
                                          HorizontalContentAlignment="Left" 
                                          Margin="0,0,0,5">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid HorizontalAlignment="Left" Grid.Row="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="65"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Uid="AboutAppName" FontSize="15" Grid.Row="0" Grid.Column="0"/>
                                            <TextBlock Text="DropStack" FontSize="15" Grid.Row="0" Grid.Column="2"/>
                                            <TextBlock x:Uid="AboutDeveloperName" FontSize="15" Grid.Row="1" Grid.Column="0"/>
                                            <TextBlock Text="Blindside Studios" FontSize="15" Grid.Row="1" Grid.Column="2"/>
                                            <TextBlock x:Uid="AboutPublisherName" FontSize="15" Grid.Row="2" Grid.Column="0"/>
                                            <TextBlock Text="Blindside Studios" FontSize="15" Grid.Row="2" Grid.Column="2"/>
                                            <TextBlock x:Uid="AboutCurrentVersion" FontSize="15" Grid.Row="3" Grid.Column="0"/>
                                            <TextBlock Text="{x:Bind GetAppVersion()}" FontSize="15" Grid.Row="3" Grid.Column="2"/>
                                            <TextBlock x:Uid="AboutCurrentLocalizationLanguage" FontSize="15" Grid.Row="4" Grid.Column="0"/>
                                            <TextBlock x:Uid="AboutCurrentLocalizationTranslator" FontSize="15" Grid.Row="4" Grid.Column="2"/>
                                        </Grid>
                                        <TextBlock x:Uid="AboutRelatedLinksHeader" FontSize="15" Grid.Row="1" HorizontalAlignment="Left" Margin="0,10,0,0"/>
                                        <HyperlinkButton x:Uid="AboutGitHubAdvertisement" HorizontalAlignment="Left" Margin="-5,0,0,0" FontSize="15" NavigateUri="https://github.com/Blindside-Studios/DropStack" Grid.Row="2"/>
                                        <HyperlinkButton x:Uid="AboutCheckUpdates" HorizontalAlignment="Left" Margin="-5,-10,0,0" FontSize="15" NavigateUri="https://github.com/Blindside-Studios/DropStack/releases" Grid.Row="3" />
                                        <HyperlinkButton x:Uid="AboutSubmitFeedback" HorizontalAlignment="Left" Margin="-5,-10,0,0" FontSize="15" NavigateUri="https://github.com/Blindside-Studios/DropStack/issues" Grid.Row="4" />
                                    </Grid>
                                </Expander>
                                <Expander x:Name="PrivacyStamentExpander" x:Uid="AboutPrivacyStatementExpander" HorizontalAlignment="Stretch" IsExpanded="False" Expanding="PrivacyStamentExpander_Expanding" Margin="0,0,0,5">
                                    <RichTextBlock>
                                        <Paragraph>
                                            <Run FontWeight="ExtraBold">About the app's local abilities</Run>
                                        </Paragraph>
                                        <Paragraph>DropStack will only ever access the folder paths that you specifically choose with the folder picker. 
                                    DropStack will also only see top-level files, meaning that anything that is inside a folder or a compressed file cannot be seen by the app. 
                                    DropStack never shares any information about your files with anyone, including first- and third-party software, as well as the developer.
                                        </Paragraph>
                                        <Paragraph Margin="0,10,0,0">
                                            <Run FontWeight="ExtraBold">About Windows Hello™️</Run>
                                        </Paragraph>
                                        <Paragraph>Authenticating with Windows Hello means that only Windows ever gets to see your biometric details, PIN or hardware key. 
                                    There is no point in time where the app is able to see your login credentials or authentication details.</Paragraph>
                                    </RichTextBlock>
                                </Expander>
                                <Expander x:Name="AttributionExpander" x:Uid="AboutAttributionsExpander" HorizontalAlignment="Stretch" IsExpanded="False" Margin="0,0,0,5">
                                    <RichTextBlock>
                                        <Paragraph>This project uses the "WinUIEx" by Morten Nielsen, which is licensed under the MIT License.</Paragraph>

                                            <Paragraph>Copyright (c) 2021 Morten Nielsen</Paragraph>

                                                <Paragraph>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</Paragraph>

                                                    <Paragraph>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</Paragraph>

                                                        <Paragraph>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</Paragraph>
                                    </RichTextBlock>
                                </Expander>
                                <Expander x:Name="FlagsExpander" Header="Experiments" Visibility="Collapsed" HorizontalAlignment="Stretch">
                                    <StackPanel Margin="5,5,5,5" Spacing="5">
                                        <TextBlock Text="These settings are highly experimental. Please modify with caution"
                                           TextWrapping="WrapWholeWords"
                                           HorizontalAlignment="Center"
                                           Opacity="0.7"
                                           FontSize="10"/>
                                        <Button x:Name="ShowDetailsPaneFlagButton" Content="EnableDetailsPane" Click="ShowDetailsPaneFlagButton_Click"/>
                                    </StackPanel>
                                </Expander>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
        <Grid x:Name="DetailsSheetGrid" Height="320" 
              CornerRadius="20" 
              VerticalAlignment="Bottom" 
              HorizontalAlignment="Stretch" 
              Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}" 
              Margin="5,0,5,-320"
              ManipulationMode="TranslateRailsY"
              ManipulationDelta="DetailsSheetGrid_ManipulationDelta"
              ManipulationCompleted="DetailsSheetGrid_ManipulationCompleted">
            <Grid.TranslationTransition>
                <Vector3Transition/>
            </Grid.TranslationTransition>
            <Grid x:Name="DetailsSheetGrabberGrid" VerticalAlignment="Top" HorizontalAlignment="Stretch" Height="50">
                <Rectangle Fill="Silver" Height="4" Width="35" RadiusX="2" RadiusY="2" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,10,0,0"/>
                <Rectangle x:Name="DetailsSheetResizeGrabber" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                <Button x:Name="DismissDetailsSheetButton" HorizontalAlignment="Right" VerticalAlignment="Top" Height="30" Width="30" Margin="0,5,5,0" CornerRadius="15" Click="DismissDetailsSheetButton_Click">
                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE8BB;" FontSize="12" Margin="-10,0,-10,0"/>
                </Button>
            </Grid>
            <Grid VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="5,30,5,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="150"/>
                    <RowDefinition Height="200"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <MediaPlayerElement x:Name="DetailsPaneVideoPlayer" CenterPoint="45,45,45" Width="90" Height="90" Visibility="Collapsed" Grid.Row="0" AutoPlay="False" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="20,20,20,20" Stretch="Uniform" Background="Transparent" PointerEntered="DetailsPaneFileThumbnail_PointerEntered" PointerExited="DetailsPaneFileThumbnail_PointerExited" DoubleTapped="DetailsPaneFileThumbnail_DoubleTapped"/>
                            <Image x:Name="DetailsPaneFileThumbnail" CenterPoint="45,45,45" Width="90" Height="90" Grid.Row="0" Source="Assets/StoreLogo.scale-400.png" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="20,20,20,20" Stretch="Uniform" Tapped="DetailsPaneFileThumbnail_Tapped" PointerEntered="DetailsPaneFileThumbnail_PointerEntered" PointerExited="DetailsPaneFileThumbnail_PointerExited" DoubleTapped="DetailsPaneFileThumbnail_DoubleTapped"/>
                        </Grid>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="Stretch">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBox x:Name="DetailsFileNameDisplay" Grid.Row="0" Text="This displays the file name" FontSize="25" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" TextAlignment="Center" Margin="0,5,5,0" Background="Transparent" BorderThickness="0">
                            <TextBox.KeyboardAccelerators>
                                <KeyboardAccelerator x:Name="EnterKeyPressFileNameEdit" Key="Enter" Invoked="EnterKeyPressFileNameEdit_Invoked"/>
                            </TextBox.KeyboardAccelerators>
                        </TextBox>
                        <Grid Grid.Row="1" HorizontalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0" Margin="0,3,2,3" Height="18" MaxWidth="200">
                                <Rectangle Fill="DarkGray" Opacity="0.3" RadiusX="9" RadiusY="9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,1,0,-1"/>
                                <TextBlock x:Name="DetailsFileTypeDisplay" Text="Filetype (.drpstck)" FontSize="13" Margin="7,0,7,0" VerticalAlignment="Center" TextTrimming="WordEllipsis"/>
                            </Grid>
                            <Grid Grid.Column="1" Height="18" Margin="2,3,0,3">
                                <Rectangle Fill="DarkGray" Opacity="0.3" RadiusX="9" RadiusY="9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,1,0,-1"/>
                                <StackPanel Orientation="Horizontal" Spacing="4" VerticalAlignment="Center" Margin="7,0,7,0">
                                    <TextBlock x:Name="DetailsFileSizeDisplay" Text="File" FontSize="13" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="DetailsFileSizeSuffixDisplay" Text="Size" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                        </Grid>
                        <TextBlock x:Name="DetailsFileModifiedDateDisplay" Grid.Row="2" Text="Modified Date" Opacity="0.5" FontSize="13" HorizontalAlignment="Center" Margin="0,3,0,3" TextTrimming="CharacterEllipsis"/>
                        <Grid Grid.Row="3" Margin="0,5,0,0">
                            <CommandBar x:Name="DetailsPaneCommandBar" Background="Transparent" IsOpen="False" DefaultLabelPosition="Right">
                                <CommandBar.PrimaryCommands>
                                    <AppBarButton x:Uid="DetailsPanePlayButton" x:Name="DetailsPanePlayButton" Visibility="Collapsed" Icon="Play" LabelPosition="Collapsed" Click="DetailsPanePlayButton_Click" Width="40"/>
                                    <AppBarButton x:Name="DetailsPaneAnnotateButton" Visibility="Collapsed" Icon="Edit" Label="Annotate" LabelPosition="Collapsed" Click="DetailsPaneAnnotateButton_Click" Width="40"/>
                                    <AppBarButton x:Name="DetailsPaneCropButton" Visibility="Collapsed" Icon="Crop" Label="Crop" LabelPosition="Collapsed" Click="DetailsPaneCropButton_Click" Width="40"/>
                                    <AppBarButton x:Name="DetailsPaneRotateButton" Visibility="Collapsed" Icon="Rotate" Label="Rotate" LabelPosition="Collapsed" Click="DetailsPaneRotateButton_Click" Width="40"/>
                                    <AppBarSeparator x:Name="DetailsPaneSeparator"/>
                                    <AppBarButton x:Name="DetailsPanePreviewButton" Icon="View" Label="Preview" LabelPosition="Collapsed" Tag="alwaysshow" Click="DetailsPanePreviewButton_Click" Width="40"/>
                                    <AppBarButton x:Name="DetailsPaneOpenWithButton" Icon="OpenWith" Label="Open with..." Tag="alwaysshow" LabelPosition="Collapsed" Click="DetailsPaneOpenWithButton_Click" Width="40"/>
                                    <AppBarButton x:Name="DetailsPaneDeleteFlyoutButton" Icon="Delete" Label="Delete" LabelPosition="Collapsed" Tag="alwaysshow" Width="40">
                                        <AppBarButton.Flyout>
                                            <Flyout x:Name="DeleteFlyout">
                                                <StackPanel Spacing="10">
                                                    <TextBlock x:Uid="DetailsPaneDeleteConfirmation" Style="{ThemeResource BaseTextBlockStyle}" Margin="0,0,0,0" />
                                                    <Button x:Uid="DetailsPaneDeleteConfirmationButton" x:Name="FileDeleteButton" Click="FileDeleteButton_Click" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Flyout>
                                        </AppBarButton.Flyout>
                                    </AppBarButton>
                                </CommandBar.PrimaryCommands>
                            </CommandBar>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</winex:WindowEx>